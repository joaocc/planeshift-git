SubDir TOP src pslaunch ;

Application psupdater :
	[ Filter [ Wildcard *.cpp *.h ] : pslaunch.cpp pawslauncherwindow.cpp pslaunch.h pawslauncherwindow.h globals.h ] : console
;

ExternalLibs psupdater : CRYSTAL CURL ;
LinkWith psupdater : xdelta3 ;

if $(HAVE_STATIC_PLUGINS) = "yes"
{

SubVariant updaterStatic ;
Application psupdater_static : [ Filter [ Wildcard *.cpp *.h ] : pslaunch.cpp pawslauncherwindow.cpp pslaunch.h pawslauncherwindow.h globals.h ] : console ;
CFlags psupdater_static : [ FDefines CS_STATIC_LINKED ] ;
LFlags psupdater_static : -lcrystalspace_staticplugins-1.2 ;
MsvcDefine psupdater_static : CS_STATIC_LINKED ;
LinkWith psupdater_static : xdelta3 ;

LinkStaticPlugins psupdater_static :
  vfs
: 
: CRYSTAL
;

ExternalLibs psupdater_static : CRYSTAL CURL ;

SubVariant ;
}

SubVariant pslauncher ;
Application pslaunch :
	[ Filter [ Wildcard *.cpp *.h ] : updater.cpp updater.h ] :
;

ExternalLibs pslaunch : CRYSTAL CURL ;
CompileGroups pslaunch : client ;
LinkWith pslaunch : xdelta3 paws psutil fparser ;
SubVariant ;

if $(HAVE_STATIC_PLUGINS) = "yes"
{

SubVariant launcherStatic ;
Application pslaunch_static : [ Filter [ Wildcard *.cpp *.h ] : updater.cpp updater.h ] : ;
CFlags pslaunch_static : [ FDefines CS_STATIC_LINKED ] ;
LFlags pslaunch_static : -lcrystalspace_staticplugins-1.2 ;
MsvcDefine pslaunch_static : CS_STATIC_LINKED ;
LinkWith pslaunch_static : xdelta3 paws psutil fparser ;

STATIC.PLUGINLIST = 
  engine
  fontplex
  imgplex
  vfs
  ;
  
STATIC.OPTIONALPLUGINLIST =
  ;

if $(TARGET.OS) != "WIN32"
{
    if $(X11.AVAILABLE) = "yes" { STATIC.PLUGINLIST += xwin ; }
    if $(XFREE86VM.AVAILABLE) = "yes" { STATIC.PLUGINLIST += xext86vm ; }
    STATIC.OPTIONALPLUGINLIST += glx2d ;
}
if $(TARGET.OS) = "WIN32" { STATIC.PLUGINLIST += glwin32 ; }
if $(TARGET.OS) = "MACOS_X" { STATIC.PLUGINLIST += glosx2d ; }

LinkStaticPlugins pslaunch_static : $(STATIC.PLUGINLIST)
: $(STATIC.OPTIONALPLUGINLIST)
: CRYSTAL
;

ExternalLibs pslaunch_static : CRYSTAL CURL ;
CompileGroups pslaunch_static : client_static ;

SubVariant ;
}

