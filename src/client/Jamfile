SubDir TOP src client ;
SubInclude TOP src client sound ;
SubInclude TOP src client gui ;

local extrafiles ;
if [ Property build : projgen ] = msvc
{
 extrafiles += [ Wildcard win32 : *.cpp *.h ] ;
}
Application psclient : [ Wildcard *.cpp *.h ] $(extrafiles) ;
ExternalLibs psclient : CRYSTAL CAL3D ;
CompileGroups psclient : client ;
LinkWith psclient : gui psnet psengine psrpgrules pssound psutil paws effects fparser ;

if $(HAVE_STATIC_PLUGINS) = "yes"
{

SubVariant static ;
if [ Property build : projgen ] = msvc
{
 extrafiles += [ Wildcard win32 : *.cpp *.h ] ;
}
Application psclient_static : [ Wildcard *.cpp *.h ] $(extrafiles) : independent noinstall nohelp ;
CFlags psclient_static : [ FDefines CS_STATIC_LINKED ] $(CAL3D.CFLAGS) ;
LFlags psclient_static : -lcrystalspace_staticplugins-$(CRYSTAL.VERSION) -lcal3d ;
MsvcDefine psclient_static : CS_STATIC_LINKED ;
LinkWith psclient_static : gui psnet psengine psrpgrules pssound psutil paws effects fparser ;

#
# The plugins that we need
#
STATIC.PLUGINLIST =
  bindoc
  bruteblock
  csddsimg
  csfont
  csgifimg
  csjpgimg
  csjngimg
  csopcode
  csparser
  cspngimg
  cssynldr
  cstgaimg
  decal
  dsplex
  dynavis
  emit
  emitldr
  engine
  engseq
  fontplex
  freefnt2
  frustvis
  genmesh
  gl3d
  glshader_cg
  glshader_fixed
  glshader_ps1
  gmeshanim
  gmeshanimpdl
  gmeshldr
  imgplex
  null2d
  null3d
  nullmesh
  nullmeshldr
  particles
  particlesldr
  ptanimimg
  ptpdlight
  rendloop_loader
  rendstep_std
  reporter
  sequence
  shadermgr
  simpleformer
  simpleformerldr
  sndmanager
  sndsysloader
  sndsysnull
  sndsysogg
  sndsysopenal
  sndsyssoft
  sndsyswav
  spr2d
  spr3d
  spr3dbin
  spr3dldr
  sprcal3d
  sprcal3dldr
  stdrep
  terrainldr
  terrain2
  terrain2ldr
  thing
  thingldr
  vfs
  xmlshader
  xmltiny
  ;

if $(TARGET.OS) != "WIN32" { if $(TARGET.OS) != "MACOS_X" { STATIC.PLUGINLIST += xwin xext86vm glx2d sndsysalsa sndsysoss ; } }
if $(TARGET.OS) = "WIN32" { STATIC.PLUGINLIST += glwin32 sndsyswin ; }
if $(TARGET.OS) = "MACOS_X" { STATIC.PLUGINLIST += glosx2d sndsyscoreaudio ; }

LinkStaticPlugins psclient_static : $(STATIC.PLUGINLIST)
:
: CRYSTAL
;

ExternalLibs psclient_static : CRYSTAL CAL3D;
CompileGroups psclient_static : client_static ;

SubVariant ;
}

