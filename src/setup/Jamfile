SubDir TOP src setup ;

Application pssetup :
	[ Wildcard *.cpp *.h ]
;

CompileGroups pssetup : client ;
ExternalLibs pssetup : CRYSTAL ;
LinkWith pssetup : paws psutil fparser ;

if $(HAVE_STATIC_PLUGINS) = "yes"
{

SubVariant static ;
Application pssetup_static : [ Wildcard *.cpp *.h ] : independent noinstall nohelp ;
CFlags pssetup_static : [ FDefines CS_STATIC_LINKED ] ;
LFlags pssetup_static : -lcrystalspace_staticplugins-$(CRYSTAL.VERSION) ;
MsvcDefine pssetup_static : CS_STATIC_LINKED ;
LinkWith pssetup_static : paws psutil fparser ;

STATIC.PLUGINLIST =
  csddsimg
  cspngimg
  csfont
  cssynldr
  dsplex
  engine
  fontplex
  freefnt2
  gl3d
  imgplex
  rendstep_std
  reporter
  shadermgr
  stdrep
  vfs
  xmlshader
  xmltiny
  ;

if $(TARGET.OS) != "WIN32" { if $(TARGET.OS) != "MACOS_X" { STATIC.PLUGINLIST += xwin xext86vm glx2d ; } }
if $(TARGET.OS) = "WIN32" { STATIC.PLUGINLIST += glwin32 ; }
if $(TARGET.OS) = "MACOS_X" { STATIC.PLUGINLIST += glosx2d ; }

LinkStaticPlugins pssetup_static : $(STATIC.PLUGINLIST)
:
: CRYSTAL
;
ExternalLibs pssetup_static : CRYSTAL ;
CompileGroups pssetup_static : client_static ;

SubVariant ;
}
